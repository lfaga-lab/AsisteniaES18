<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#f7f9fc" />
  <title>Asistencia</title>
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <div id="app" class="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo">âœ“</div>
        <div class="brandText">
          <div class="brandTitle">Asistencia</div>
          <div id="brandSubtitle" class="brandSub">Conectandoâ€¦</div>
        </div>
      </div>
      <div class="topActions">
        <button id="btnSync" class="iconBtn" title="Actualizar" aria-label="Actualizar">âŸ³</button>
        <button id="btnLogout" class="iconBtn" title="Salir" aria-label="Salir">â‹</button>
      </div>
    </header>

    <main class="viewport">
      <!-- Login -->
      <section id="screenLogin" class="screen">
        <div class="card cardLg">
          <h1 class="h1">Entrar</h1>
          <p class="muted">IngresÃ¡ con tu email + PIN (definidos en la pestaÃ±a <b>Users</b>).</p>
          <form id="loginForm" class="form">
            <label class="field">
              <span>Email</span>
              <input id="loginEmail" type="email" autocomplete="username" placeholder="preceptor@escuela.edu.ar" required />
            </label>
            <label class="field">
              <span>PIN</span>
              <input id="loginPin" type="password" inputmode="numeric" autocomplete="current-password" placeholder="â€¢â€¢â€¢â€¢" required />
            </label>
            <button class="btn btnPrimary btnFull" type="submit">Ingresar</button>
            <button id="btnTest" class="pill" type="button" style="justify-content:center">ğŸ”Œ Probar conexiÃ³n</button>
            <div id="backendInfo" class="muted" style="margin-top:6px; word-break:break-all"></div>
            <div id="loginError" class="error" hidden></div>
          </form>

          <div class="muted" style="margin-top:10px">
            Si se queda â€œCargandoâ€¦â€, revisÃ¡ el <b>WEB_APP_URL</b> en <code>config.js</code>.
          </div>
        </div>
      </section>

      <!-- Courses -->
      <section id="screenCourses" class="screen" hidden>
        <div class="card cardLg">
          <h2 class="h2">ElegÃ­ un curso</h2>
          <div class="row">
            <button id="btnPickDate" class="pill" type="button">ğŸ“… <span id="sessionDateLabel">Hoy</span></button>
            <button id="btnOpenAlerts" class="pill" type="button">ğŸ”” Alertas</button>
          </div>
          <div id="coursesGrid" class="grid"></div>
          <div class="help muted">Tip: tocÃ¡ un curso para empezar. Todo sin scrollear ğŸ˜‰</div>
        </div>
      </section>

      <!-- Take attendance -->
      <section id="screenTake" class="screen" hidden>
        <div class="takeLayout">
          <div class="progress">
            <div class="progressInfo">
              <div id="courseTitle" class="h2">Curso</div>
              <div class="muted"><span id="progressText">0/0</span> Â· <span id="sessionDateTake">â€”</span></div>
            </div>
            <div class="progressBar">
              <div id="progressFill" class="progressFill"></div>
            </div>
          </div>

          <div id="cardStage" class="cardStage" aria-live="polite"></div>

          <div class="actionsDock">
            <button id="btnAbsent" class="dockBtn dockDanger" type="button">âŒ<span>Falta</span></button>
            <button id="btnLater" class="dockBtn dockNeutral" type="button">â­<span>DespuÃ©s</span></button>
            <button id="btnTardy" class="dockBtn dockWarn" type="button">â°<span>Tarde</span></button>
            <button id="btnPresent" class="dockBtn dockGood" type="button">âœ…<span>Presente</span></button>
          </div>

          <div class="bottomRow">
            <button id="btnOpenDeferred" class="pill" type="button">â­ DespuÃ©s: <b id="deferredCount">0</b></button>
            <button id="btnFinishSession" class="pill pillPrimary" type="button">Cerrar toma</button>
          </div>
        </div>
      </section>
    </main>

    <div id="toast" class="toast" hidden></div>

    <!-- Bottom sheet -->
    <div id="overlay" class="overlay" hidden>
      <div id="sheet" class="sheet" role="dialog" aria-modal="true" aria-labelledby="sheetTitle">
        <div class="sheetHeader">
          <div>
            <div id="sheetTitle" class="sheetTitle">â€”</div>
            <div id="sheetSubtitle" class="sheetSub muted">â€”</div>
          </div>
          <button id="btnCloseSheet" class="iconBtn" aria-label="Cerrar">âœ•</button>
        </div>
        <div id="sheetBody" class="sheetBody"></div>
        <div id="sheetFooter" class="sheetFooter" hidden></div>
      </div>
    </div>

    <div id="veil" class="veil" hidden>
      <div class="spinner"></div>
      <div id="veilText" class="veilText">Cargandoâ€¦</div>
    </div>
  </div>

  <script src="./config.js"></script>
  <script src="./app.js"></script>
</body>
</html>
